<!DOCTYPE html>
<html>
<head>
    <title>JSONP Endpoint</title>
</head>
<body>
    <script>
        // 1. Get the URL parameters
        const params = new URLSearchParams(window.location.search);
        
        // 2. Get the value of the 'text' parameter
        const urlText = params.get('text') || "no text provided";
        
        // 3. Get the callback function name
        const callbackName = params.get('callback');

        // 4. Construct the JavaScript object (your 'API' response)
        const responseObject = {
            status: "success",
            data_received: urlText,
            timestamp: new Date().toISOString()
        };

        // 5. Convert the object to a JSON string
        const jsonString = JSON.stringify(responseObject);

        // 6. Output the JSONP response: callbackName(jsonString)
        if (callbackName) {
            // Write the JSONP wrapper directly into the document
            document.write(`${callbackName}(${jsonString});`);
        } else {
            // If no callback is specified, just display the JSON string
            document.write(jsonString);
        }
    </script>
</body>
</html>
